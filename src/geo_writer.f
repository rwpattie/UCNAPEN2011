      program geo_writer
c---------------------------------------------------------------------c
c     The parameters athick and cthick specify the diameter in cm of 
c     the anode and cathode wires respectively.
c---------------------------------------------------------------------c
      double precision athick
      double precision cthick
      integer offset
      PARAMETER(offset = 700,athick = 10e-4,cthick = 76.2e-4)
      CHARACTER*12 ANODEW,ANODEE,CATHODEW,CATHODEE
      PARAMETER(ANODEW ='anode_west',ANODEE  ='anode_east',
     1         CATHODEE='catho_east',CATHODEW='catho_west')
     
      CALL WRITE_ANODE_PLANE(0,ATHICK,ANODEE,0)
      CALL WRITE_ANODE_PLANE(OFFSET,ATHICK,ANODEW,1)
      CALL WRITE_CATHODE_PLANE(OFFSET,CTHICK,CATHODEW,1)
      CALL WRITE_CATHODE_PLANE(0,CTHICK,CATHODEE,0)
    
      END
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC      
      SUBROUTINE WRITE_ANODE_PLANE(OFFSET,THICK,FNAME,SIDE)
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      CHARACTER*12 FNAME
      INTEGER OFFSET,J,SIDE
      DOUBLE PRECISION THICK,XPOS
      ! OPEN FILE
      open(21,file=FNAME)
      ! WRITE FIRST LINE OF X'S AND 0'S
      write(21,'(64(''X''))')
      Write(21,'(64(''0''))')
      ! DEFINE THE TERMINATION PLANE IN THE Y-AXIS
      WRITE(21,'(A9,I4,A9)')'SURFACE (',OFFSET+1,')  PLANE '
      WRITE(21,'(A24)')'INDICES=( 0, 1, 0, 0,-1)'
      WRITE(21,'(A37)')'Y-SCALE=( 8.382000000000000E+00,   0)'
      ! NOW LOOP OVER AND WRITE THE WIRES
      do j= 2+offset,65+offset
        xpos=-8.382E0+(j-offset)*0.254E0
        CALL WRITE_WIRE(21,J,XPOS,THICK,OFFSET+1,0,5)
      ENDDO
      ! MAKE A BOUNDING GAS VOLUME
      Write(21,'(64(''0''))')
      WRITE(21,'(A9,I4,A9)')'SURFACE (',66+OFFSET,')  PLANE '
      WRITE(21,'(A24)')'INDICES=( 0, 0, 1, 0,-1)'
      WRITE(21,'(A37)')'Z-SCALE=( 0.100000000000000E+00,   0)'
      Write(21,'(64(''0''))')
      WRITE(21,'(A9,I4,A1)')'SURFACE (',OFFSET+67,')'
      WRITE(21,'(A24)')'INDICES=( 1, 0, 0, 0,-1)'
      WRITE(21,'(A37)')'X-SCALE=( 8.382000000000000E+00,   0)'
      ! START MODULE DEFINITION
      Write(21,'(64(''0''))')
      WRITE(21,'(A9,I4,A1)')'MODULE  (',OFFSET+65,')'
      WRITE(21,'(A14)')'MATERIAL(   1)'
      WRITE(21,'(A9,I4,A20)')
     1 'SURFACE (',OFFSET+1,'), SIDE POINTER=(-1)'
      WRITE(21,'(A9,I4,A20)')
     1 'SURFACE (',OFFSET+66,'), SIDE POINTER=(-1)'
      WRITE(21,'(A9,I4,A20)')
     1 'SURFACE (',OFFSET+67,'), SIDE POINTER=(-1)'
      
      DO J=1+offset,64+offset
        WRITE(21,'(A9,I4,A2)')'BODY    (',J,') '
      ENDDO
      ! SHIFT OF THE MODULE
      WRITE(21,'(64(''1''))')
      IF(SIDE.EQ.0)THEN
       WRITE(21,'(A37)')'Z-SHIFT=(-2.220000000000000E+02,   0)'
      ELSE IF(SIDE.EQ.1)THEN
       WRITE(21,'(A37)')'Z-SHIFT=( 2.220000000000000E+02,   0)'
      END IF
      Write(21,'(64(''0''))')
      Write(21,'(A10,54(''0''))')'END       '
      CLOSE(21)
      RETURN
      END
cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c     A COMPLETE GEOMETRY FILE FOR THE ANODE PLANE IS CLOSED AND 
C     NOW A FILE IS OPENED FOR THE CATHODE PLANES
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      SUBROUTINE WRITE_CATHODE_PLANE(OFFSET,THICK,FNAME,SIDE)
      CHARACTER*12 FNAME
      INTEGER OFFSET,J,SIDE
      DOUBLE PRECISION THICK,XPOS
      open(21,file=FNAME)
      write(21,'(64(''X''))')
      Write(21,'(64(''0''))')
      WRITE(21,'(A9,I4,A9)')
     1  'SURFACE (',OFFSET+101,')  PLANE '
      WRITE(21,'(A24)')'INDICES=( 0, 1, 0, 0,-1)'
      WRITE(21,'(A37)')'Y-SCALE=( 8.382000000000000E+00,   0)'

      do j= 102+offset,166+offset
        xpos=-8.382E0+(j-101-offset)*0.254E0
        CALL WRITE_WIRE(21,J,XPOS,THICK,OFFSET+101,1,5)
      ENDDO
      
      Write(21,'(64(''0''))')
      WRITE(21,'(A9,I4,A1)')'SURFACE (',OFFSET+167,')'
      WRITE(21,'(A24)')'INDICES=( 0, 0, 1, 0,-1)'
      WRITE(21,'(A37)')'Z-SCALE=( 0.050000000000000E+00,   0)'
      WRITE(21,'(A37)')'Z-SHIFT=( 1.000000000000000E+00,   0)'
      Write(21,'(64(''0''))')
      WRITE(21,'(A9,I4,A1)')'SURFACE (',OFFSET+168,')'
      WRITE(21,'(A24)')'INDICES=( 1, 0, 0, 0,-1)'
      WRITE(21,'(A37)')'X-SCALE=( 8.382000000000000E+00,   0)'
      Write(21,'(64(''0''))')
      WRITE(21,'(A9,I4,A1)')'MODULE  (',OFFSET+166,')'
      WRITE(21,'(A14)')'MATERIAL(   1)'
      DO J=102+offset,166+offset
        WRITE(21,'(A9,I4,A2)')'BODY    (',J-1,') '
      ENDDO
      WRITE(21,'(A9,I4,A20)')
     1 'SURFACE (',OFFSET+101,'), SIDE POINTER=(-1)'
      WRITE(21,'(A9,I4,A20)')
     1 'SURFACE (',OFFSET+167,'), SIDE POINTER=(-1)'
      WRITE(21,'(A9,I4,A20)')
     1 'SURFACE (',OFFSET+168,'), SIDE POINTER=(-1)'
      ! SHIFT OF THE MODULE
      WRITE(21,'(64(''1''))')
      IF(SIDE.EQ.0)THEN
       WRITE(21,'(A37)')'Z-SHIFT=(-2.220000000000000E+02,   0)'
      ELSE IF(SIDE.EQ.1)THEN
       WRITE(21,'(A37)')'Z-SHIFT=( 2.220000000000000E+02,   0)'
      END IF

      do j= 167+offset,231+offset
        xpos=-8.382E0+(j-166-offset)*0.254E0
        CALL WRITE_WIRE(21,J+2,XPOS,THICK,OFFSET+101,-1,5)
      ENDDO
      Write(21,'(64(''0''))')
      WRITE(21,'(A9,I4,A1)')'SURFACE (',OFFSET+234,')'
      WRITE(21,'(A24)')'INDICES=( 0, 0, 1, 0,-1)'
      WRITE(21,'(A37)')'Z-SCALE=( 0.050000000000000E+00,   0)'
      WRITE(21,'(A37)')'Z-SHIFT=(-1.000000000000000E+00,   0)'
      
      Write(21,'(64(''0''))')
      WRITE(21,'(A9,I4,A1)')'MODULE  (',OFFSET+232,')'
      WRITE(21,'(A14)')'MATERIAL(   1)'
      DO J=167+offset,231+offset
        WRITE(21,'(A9,I4,A2)')'BODY    (',J,') '
      ENDDO
      WRITE(21,'(A9,I4,A20)')
     1 'SURFACE (',OFFSET+101,'), SIDE POINTER=(-1)'
      WRITE(21,'(A9,I4,A20)')
     1 'SURFACE (',OFFSET+234,'), SIDE POINTER=(-1)'
      WRITE(21,'(A9,I4,A20)')
     1 'SURFACE (',OFFSET+168,'), SIDE POINTER=(-1)'
      WRITE(21,'(64(''1''))')
      WRITE(21,'(A37)')'  OMEGA=( 9.000000000000000E+01,   0)'
      IF(SIDE.EQ.0)THEN
       WRITE(21,'(A37)')'Z-SHIFT=(-2.220000000000000E+02,   0)'
      ELSE IF(SIDE.EQ.1)THEN
       WRITE(21,'(A37)')'Z-SHIFT=( 2.220000000000000E+02,   0)'
      END IF
      Write(21,'(64(''0''))')
      Write(21,'(A10,54(''0''))')'END       '
      CLOSE(21)
      RETURN
      END
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      SUBROUTINE WRITE_WIRE(NFILE,NIT,XPOS,THICK,OFFSET,NCATH,NMAT)
      INTEGER NFILE,NIT,OFFSET,NCATH,NMAT
      DOUBLE PRECISION XPOS,THICK
      
      Write(NFILE,'(64(''0''))')
      WRITE(NFILE,'(A9,I4,A7,I3)')'SURFACE (',NIT,') wire ',NIT
      WRITE(NFILE,'(A24)')'INDICES=( 1, 0, 1, 0,-1)'
      WRITE(NFILE,'(A9,E22.15,A6)')'X-SCALE=(',THICK/2.,',   0)'
      WRITE(NFILE,'(A9,E22.15,A6)')'Z-SCALE=(',THICK/2.,',   0)'
      WRITE(NFILE,'(A9,E22.15,A6)')'X-SHIFT=(',xpos,',   0)'
      IF(NCATH.EQ.-1)THEN
         WRITE(NFILE,'(A37)')'Z-SHIFT=(-1.000000000000000E+00,   0)'
      ELSE IF(NCATH.EQ.1)THEN
        WRITE(NFILE,'(A37)')'Z-SHIFT=( 1.000000000000000E+00,   0)'
      END IF
      Write(NFILE,'(64(''0''))')
      WRITE(NFILE,'(A9,I4,A2)')'BODY    (',NIT-1,') '
      WRITE(NFILE,'(A9,I4,A1)')'MATERIAL(',NMAT,')'
      WRITE(NFILE,'(A9,I4,A20)')
     1 'SURFACE (',OFFSET,'), SIDE POINTER=(-1)'
      WRITE(NFILE,'(A9,I4,A20)')'SURFACE (',NIT,'), SIDE POINTER=(-1)'
      
      RETURN
      END
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c-----------------------------------------------------------------------c
c------------- now comes the hardware  ---------------------------------c
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!       OPEN(21,FILE="mwpc_east")
!       write(21,'(A64)')'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
!      1XXXXXXXXXXXXXXXXXX'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (300)' ! extrior radius
!       WRITE(21,'(A24)')'INDICES=( 1, 1, 0, 0,-1)'
!       WRITE(21,'(A37)')'X-SCALE=( 9.500000000000000E+00,   0)'
!       WRITE(21,'(A37)')'Y-SCALE=( 9.500000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (301)' ! interior radius
!       WRITE(21,'(A24)')'INDICES=( 1, 1, 0, 0,-1)'
!       WRITE(21,'(A37)')'X-SCALE=( 7.500000000000000E+00,   0)'
!       WRITE(21,'(A37)')'Y-SCALE=( 7.500000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (302)' ! front and back planes
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 1, 0,-1)'
!       WRITE(21,'(A37)')'Z-SCALE=( 2.500000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A28)')'BODY    (300), mwpc houseing '
!       WRITE(21,'(A13)')'MATERIAL(  5)'
!       WRITE(21,'(A32)')'SURFACE (301), SIDE POINTER=(+1)'
!       WRITE(21,'(A32)')'SURFACE (300), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (302), SIDE POINTER=(-1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (303) ' ! back  of mylar
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 0, 1,-1)'
!       WRITE(21,'(A37)')'Z-SHIFT=( 1.500000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (304) ' !front  of mylar
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 0, 1,-1)'
!       WRITE(21,'(A37)')'Z-SHIFT=( 1.500600000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'BODY    (301) ' ! mylar plane
!       WRITE(21,'(A13)')'MATERIAL(  3)'
!       WRITE(21,'(A32)')'SURFACE (301), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (303), SIDE POINTER=(+1)'
!       WRITE(21,'(A32)')'SURFACE (304), SIDE POINTER=(-1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (305) ' ! back mylar window
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 0, 1,-1)'
!       WRITE(21,'(A37)')'Z-SHIFT=(-3.500000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (306) ' ! front mylar window
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 0, 1,-1)'
!       WRITE(21,'(A37)')'Z-SHIFT=(-3.500600000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'BODY    (302) ' ! mylar
!       WRITE(21,'(A13)')'MATERIAL(  3)'
!       WRITE(21,'(A32)')'SURFACE (301), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (305), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (306), SIDE POINTER=(+1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (307) ' ! pvt
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 0, 1,-1)'
!       WRITE(21,'(A37)')'Z-SHIFT=(-3.500600000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (308) ' ! pvt
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 0, 1,-1)'
!       WRITE(21,'(A37)')'Z-SHIFT=(-3.850600000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'BODY    (303) ' ! pvt
!       WRITE(21,'(A13)')'MATERIAL(  2)'
!       WRITE(21,'(A32)')'SURFACE (301), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (307), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (308), SIDE POINTER=(+1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'BODY    (313) ' ! pvt
!       WRITE(21,'(A13)')'MATERIAL(  1)'
!       WRITE(21,'(A32)')'SURFACE (301), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (302), SIDE POINTER=(-1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (322)' ! front and back planes
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 1, 0,-1)'
!       WRITE(21,'(A37)')'Z-SCALE=( 3.000000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'MODULE  (312)'
!       WRITE(21,'(A13)')'MATERIAL(  0)'
!       WRITE(21,'(A32)')'SURFACE (300), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (322), SIDE POINTER=(-1)'
!       WRITE(21,'(A13)')'BODY    (300)'
!       WRITE(21,'(A13)')'BODY    (301)'
!       WRITE(21,'(A13)')'BODY    (302)'
!       WRITE(21,'(A13)')'BODY    (303)'
!       WRITE(21,'(A13)')'BODY    (313)'
!       WRITE(21,'(A64)')'111111111111111111111111111111111111111111111111
!      1111111111111111111'
!       WRITE(21,'(A37)')'Z-SHIFT=(-2.225000000000000E+02,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       Write(21,'(A64)')'END       00000000000000000000000000000000000000
!      1000000000000000000'
!       CLOSE(21)
! cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
! cc		Write west detector
! cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!       OPEN(21,FILE="mwpc_west")
!       write(21,'(A64)')'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
!      1XXXXXXXXXXXXXXXXXX'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (400)' ! extrior radius
!       WRITE(21,'(A24)')'INDICES=( 1, 1, 0, 0,-1)'
!       WRITE(21,'(A37)')'X-SCALE=( 9.500000000000000E+00,   0)'
!       WRITE(21,'(A37)')'Y-SCALE=( 9.500000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (401)' ! interior radius
!       WRITE(21,'(A24)')'INDICES=( 1, 1, 0, 0,-1)'
!       WRITE(21,'(A37)')'X-SCALE=( 7.500000000000000E+00,   0)'
!       WRITE(21,'(A37)')'Y-SCALE=( 7.500000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (402)' ! front and back planes
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 1, 0,-1)'
!       WRITE(21,'(A37)')'Z-SCALE=( 2.500000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A28)')'BODY    (400), mwpc houseing '
!       WRITE(21,'(A13)')'MATERIAL(  5)'
!       WRITE(21,'(A32)')'SURFACE (401), SIDE POINTER=(+1)'
!       WRITE(21,'(A32)')'SURFACE (400), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (402), SIDE POINTER=(-1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (403) ' ! back  of mylar
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 0, 1,-1)'
!       WRITE(21,'(A37)')'Z-SHIFT=( 1.500000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (404) ' !front  of mylar
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 0, 1,-1)'
!       WRITE(21,'(A37)')'Z-SHIFT=( 1.600600000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'BODY    (401) ' ! mylar plane
!       WRITE(21,'(A13)')'MATERIAL(  3)'
!       WRITE(21,'(A32)')'SURFACE (401), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (403), SIDE POINTER=(+1)'
!       WRITE(21,'(A32)')'SURFACE (404), SIDE POINTER=(-1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (405) ' ! back mylar window
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 0, 1,-1)'
!       WRITE(21,'(A37)')'Z-SHIFT=(-3.500000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (406) ' ! front mylar window
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 0, 1,-1)'
!       WRITE(21,'(A37)')'Z-SHIFT=(-3.500600000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'BODY    (402) ' ! mylar
!       WRITE(21,'(A13)')'MATERIAL(  3)'
!       WRITE(21,'(A32)')'SURFACE (401), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (405), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (406), SIDE POINTER=(+1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (407) ' ! pvt
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 0, 1,-1)'
!       WRITE(21,'(A37)')'Z-SHIFT=(-3.500600000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (408) ' ! pvt
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 0, 1,-1)'
!       WRITE(21,'(A37)')'Z-SHIFT=(-3.850600000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'BODY    (403) ' ! pvt
!       WRITE(21,'(A13)')'MATERIAL(  2)'
!       WRITE(21,'(A32)')'SURFACE (401), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (407), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (408), SIDE POINTER=(+1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (422)' ! front and back planes
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 1, 0,-1)'
!       WRITE(21,'(A37)')'Z-SCALE=( 3.000000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A28)')'BODY    (415), mwpc houseing '
!       WRITE(21,'(A13)')'MATERIAL(  1)'
!       WRITE(21,'(A32)')'SURFACE (401), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (402), SIDE POINTER=(-1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'MODULE  (404)'
!       WRITE(21,'(A13)')'MATERIAL(  0)'
!       WRITE(21,'(A32)')'SURFACE (400), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (422), SIDE POINTER=(-1)'
!       WRITE(21,'(A13)')'BODY    (400)'
!       WRITE(21,'(A13)')'BODY    (401)'
!       WRITE(21,'(A13)')'BODY    (402)'
!       WRITE(21,'(A13)')'BODY    (403)'
!       WRITE(21,'(A13)')'BODY    (415)'
!       WRITE(21,'(A64)')'111111111111111111111111111111111111111111111111
!      1111111111111111111'
!       WRITE(21,'(A37)')'  THETA=( 1.800000000000000E+02,   0)'
!       WRITE(21,'(A37)')'Z-SHIFT=( 2.225000000000000E+02,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       Write(21,'(A64)')'END       00000000000000000000000000000000000000
!      1000000000000000000'
!       CLOSE(21)
! cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
! c               Generating the decay_volume
! cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!       OPEN(21,FILE='decay_volume')
!       write(21,'(A64)')'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
!      1XXXXXXXXXXXXXXXXXX'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (309)' ! quartz tubing od
!       WRITE(21,'(A24)')'INDICES=( 1, 1, 0, 0,-1)'
!       WRITE(21,'(A37)')'X-SCALE=( 5.000000000000000E+00,   0)'
!       WRITE(21,'(A37)')'Y-SCALE=( 5.000000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (310)' ! quartz tubing id
!       WRITE(21,'(A24)')'INDICES=( 1, 1, 0, 0,-1)'
!       WRITE(21,'(A37)')'X-SCALE=( 4.700000000000000E+00,   0)'
!       WRITE(21,'(A37)')'Y-SCALE=( 4.700000000000000E+00,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (311)' ! quartz tubing 
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 1, 0,-1)'
!       WRITE(21,'(A37)')'Z-SCALE=( 1.500000000000000E+02,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A28)')'BODY    (304), DECAY VOLUME '
!       WRITE(21,'(A13)')'MATERIAL(  4)'
!       WRITE(21,'(A32)')'SURFACE (309), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (310), SIDE POINTER=(+1)'
!       WRITE(21,'(A32)')'SURFACE (311), SIDE POINTER=(-1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (312)' ! kapton window
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 1, 0,-1)'
!       WRITE(21,'(A37)')'Z-SCALE=( 1.500000000000000E+02,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (313)' ! kapton window
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 1, 0,-1)'
!       WRITE(21,'(A37)')'Z-SCALE=( 1.500008000000000E+02,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'BODY    (305)' ! kapton window
!       WRITE(21,'(A13)')'MATERIAL(  6)'
!       WRITE(21,'(A32)')'SURFACE (309), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (312), SIDE POINTER=(+1)'
!       WRITE(21,'(A32)')'SURFACE (313), SIDE POINTER=(-1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'SURFACE (316)' ! copper window
!       WRITE(21,'(A24)')'INDICES=( 0, 0, 1, 0,-1)'
!       WRITE(21,'(A37)')'Z-SCALE=( 1.500008100000000E+02,   0)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A13)')'BODY    (306)' ! copper window
!       WRITE(21,'(A13)')'MATERIAL( 10)'
!       WRITE(21,'(A32)')'SURFACE (309), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (316), SIDE POINTER=(-1)'
!       WRITE(21,'(A32)')'SURFACE (313), SIDE POINTER=(+1)'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       Write(21,'(A64)')'END       00000000000000000000000000000000000000
!      1000000000000000000'
!       close(21)
! ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
! c              WRITE A FILE TO INCLUDE THESE CONSTRUCTS
! ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
!       OPEN(21,FILE='detector')
!       write(21,'(A64)')'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
!      1XXXXXXXXXXXXXXXXXX'
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A8)')'INCLUDE '
!       WRITE(21,'(A23)')'FILE=   (mwpc_east   ) '
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A8)')'INCLUDE '
!       WRITE(21,'(A23)')'FILE=   (mwpc_west   ) '
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       WRITE(21,'(A8)')'INCLUDE '
!       WRITE(21,'(A23)')'FILE=   (decay_volume) '
!       Write(21,'(A64)')'000000000000000000000000000000000000000000000000
!      1000000000000000000'
!       Write(21,'(A64)')'END       00000000000000000000000000000000000000
!      1000000000000000000'
!       close(21)
!       end
